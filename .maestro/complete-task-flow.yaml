# =============================================================================
# Complete Task E2E Test Flow
# =============================================================================
# 
# Test Plan Reference: TI-005 to TI-008
# 
# This flow tests toggling tasks between completed and incomplete states:
# - TI-005: Verify checkbox toggles on tap
# - TI-006: Verify completed task visual styling (strikethrough)
# - TI-007: Verify completed task opacity change
# - TI-008: Verify unchecking completed task
#
# Prerequisites:
# - App must be installed on device/emulator
# - App state should be cleared before running
#
# Run command: maestro test .maestro/complete-task-flow.yaml
# =============================================================================

appId: com.todocat.app

---

# -----------------------------------------------------------------------------
# SETUP: Launch app and add a test task
# -----------------------------------------------------------------------------
- launchApp:
    clearState: true
    clearKeychain: true

# Complete welcome flow
- extendedWaitUntil:
    visible: "Welcome to TodoCat"
    timeout: 10000
- tapOn: "Go"

- extendedWaitUntil:
    visible: "My Tasks"
    timeout: 5000

# Add a task to complete
- tapOn:
    id: "add-task-fab"

- extendedWaitUntil:
    visible: "Add New Task"
    timeout: 3000

- tapOn:
    id: "task-input"
- inputText: "Task to complete"
- tapOn: "Add Task"

- extendedWaitUntil:
    visible: "Task to complete"
    timeout: 3000

# -----------------------------------------------------------------------------
# TEST: TI-005 - Toggle Checkbox
# Description: Taps on task to mark it as completed
# Expected: Task checkbox toggles to completed state
# -----------------------------------------------------------------------------
# Tap on the task item to toggle completion
- tapOn: "Task to complete"

# Wait for animation
- extendedWaitUntil:
    timeout: 1000

# -----------------------------------------------------------------------------
# TEST: TI-006 & TI-007 - Completed Task Visual Styling
# Description: Verifies completed task has strikethrough and reduced opacity
# Expected: Task text appears with strikethrough styling
# Note: Visual styling is handled by the component, we verify the task is still visible
# -----------------------------------------------------------------------------
# Task should still be visible (with completed styling)
- assertVisible: "Task to complete"

# -----------------------------------------------------------------------------
# TEST: TI-008 - Uncomplete Task
# Description: Taps completed task to mark it as incomplete again
# Expected: Task returns to uncompleted state
# -----------------------------------------------------------------------------
# Tap again to uncomplete
- tapOn: "Task to complete"

# Wait for animation
- extendedWaitUntil:
    timeout: 1000

# Task should still be visible (now uncompleted)
- assertVisible: "Task to complete"
